

> é¢˜ç›®æ¥æºäº[ã€æ”»é˜²ä¸–ç•Œã€‘]( https://adworld.xctf.org.cn/challenges/list)

# é¢˜ç›®
- åç§°ï¼š base64
- ç¼–å·ï¼š GFSJ0522
- éš¾åº¦:1
- é¢˜ç›®æ¥æºï¼š`poxlove3`
- é¢˜ç›®æè¿°ï¼š
	`å…ƒå®µèŠ‚ç¯è°œæ˜¯ä¸€ç§å¤è€çš„ä¼ ç»Ÿæ°‘é—´è§‚ç¯çŒœè°œçš„ä¹ ä¿—ã€‚ å› ä¸ºè°œè¯­èƒ½å¯è¿ªæ™ºæ…§åˆé¥¶æœ‰å…´è¶£ï¼Œç¯è°œå¢æ·»èŠ‚æ—¥æ°”æ°›ï¼Œæ˜¯ä¸€é¡¹å¾ˆæœ‰è¶£çš„æ´»åŠ¨ã€‚ ä½ ä¹Ÿå¾ˆå–œæ¬¢è¿™ä¸ªæ¸¸æˆï¼Œè¿™ä¸ï¼Œä»Šå¹´å…ƒå®µèŠ‚ï¼Œå¿ƒé‡Œæœ‰ä¸ªé»‘å®¢æ¢¦çš„ä½ ï¼Œçº¦ä¸Šä½ é’æ¢…ç«¹é©¬çš„å¥½ä¼™ä¼´å°é±¼ï¼Œ æ¥åˆ°äº†cyberpeaceçš„æ”»é˜²ä¸–ç•ŒçŒœè°œå¤§ä¼šï¼Œä¹Ÿæƒ³ç€ä¸€å±•èº«æ‰‹ã€‚
ä½ ä»¬ä¸€èµ·æ¥åˆ°äº†å°å­©å­å½å½å–³å–³åµåµé—¹é—¹çš„åœ°æ–¹ï¼Œä½ ä¿©æŠ¬å¤´ä¸€çœ‹ï¼Œä¸Šé¢çš„å¤§çº¢ç¯ç¬¼ä¸Šå†™ç€ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ å­—ç¬¦ä¸²ï¼Œå°é±¼æ­£çº³é—·å‘¢ï¼Œä½ ç¥ç§˜ä¸€ç¬‘ï¼Œæˆ‘çŸ¥é“è¿™æ˜¯ä»€ä¹ˆäº†ã€‚`

- é¢˜ç›®é™„ä»¶:
	`Y3liZXJwZWFjZXtXZWxjb21lX3RvX25ld19Xb3JsZCF9`

# é¢˜è§£
- è¿™ä¸ªé¢˜å®é™…ä¸Šæ˜¯æ²¡æœ‰ä»»ä½•éš¾åº¦çš„ï¼Œä»é¢˜ç›®ã€Base64ã€‘å°±å¯ä»¥çŒœåˆ°ï¼Œé™„ä»¶ä¸­çš„å­—ç¬¦ä¸²åº”è¯¥æ˜¯ `Base64` è½¬ç ä¹‹åçš„å†…å®¹ï¼Œéšä¾¿æ‰¾ä¸ª`åœ¨çº¿è§£ç ` ç½‘ç«™ï¼Œå°±å¯ä»¥å¾—åˆ° `flag` ï¼š `cyberpeace{Welcome_to_new_World!}`
	![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/e32042f7e13e4fe6a89bc1991d66bd34.png)

# æ‰©å±•
> è¿™é‡Œä¸»è¦èŠä¸€ä¸‹ `Base64` çš„åŸç†ã€‚

è¯´åˆ° `Base64`ï¼Œå°±ä¸å¾—ä¸è¯´ä¸€ä¸ªæœ€è®©äººè§‰å¾—æ¶å¿ƒçš„ç°è±¡â€”â€”**ä¹±ç **ï¼ˆæƒ³å¿…éƒ½ä¸é™Œç”Ÿå§ï¼‰ã€‚
- `?  M<+   ï£µï£µï£µï£µï£µï£µï£µï£µ 7 Intel(R) `
- `   é¸€RåŸ·ï£µï£µ    	`
- `é”Ÿæ–¤æ‹·Â·çƒ«çƒ«çƒ«~`

> ä¹±ç ç©¶ç«Ÿæ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ

å…¶åŸå› æ— éå°±ä¸€å¥è¯ï¼š æŸç§ç¼–ç ä¸‹å¯¹åº”çš„äºŒè¿›åˆ¶ç¬¦å·åœ¨å¦ä¸€ç§ç¼–ç ä¸‹æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ï¼Œæˆ–è€…å¯¹åº”å¦ä¸€ç§å­—ç¬¦ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š å‡è®¾ `BIG5` ç¼–ç ä¸‹ï¼Œ `ä½ ` å¯¹åº”çš„äºŒè¿›åˆ¶ä¸º `00001111`ï¼Œ `å¥½` å¯¹åº”çš„äºŒè¿›åˆ¶ä¸º `01110011`ï¼Œ é‚£ä¹ˆæ–‡å­—`ä½ å¥½`å¯¹åº”çš„äºŒè¿›åˆ¶å°±ä¸º`0000111101110011`ï¼Œè€Œå½“ç”¨ `GBK2312`ç¼–ç è¯»å–è¿™ä¸¤ä¸ªå­—æ—¶ï¼Œ`00001111`å¯¹åº”çš„æ˜¯`é”Ÿ`ï¼Œ`01110011`å¯¹åº”çš„æ˜¯ç©ºå­—ç¬¦ï¼Œé‚£ä¹ˆè¯»å–åˆ°çš„å†…å®¹å°±ä¼šå˜æˆ `é”Ÿ`ï¼Œä¹Ÿå°±æ˜¯**ä¹±ç **ã€‚

> `Base64` å’Œä¹±ç æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ

`Base64` å…¶å®å¹¶ä¸èƒ½ç§°ä¹‹ä¸ºåŠ /è§£å¯†ç®—æ³•ï¼Œå‡†ç¡®æ¥è¯´ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ª**å¯è¯»æ€§ç®—æ³•**ã€‚å®ƒçš„ç›®çš„å°±æ˜¯é˜²æ­¢å‡ºç°ä¹±ç ï¼Œæå‡å¯è¯»æ€§ã€‚
`Base64` æ˜¯ç”± `A-Z`ã€`a-z`ã€`0-9` è¿™ `62` ä¸ªæ•°å­—å’Œå­—æ¯ï¼ŒåŠ ä¸Š `+` å’Œ `/` è¿™ä¸¤ä¸ªç¬¦å·ï¼Œå…±ç»„æˆçš„ `64` ä½åŸºç¡€ç¬¦å·ã€‚æ— è®ºæ˜¯å“ªç§ç¼–ç ä¸‹çš„ä»€ä¹ˆå†…å®¹ï¼Œç»è¿‡ `Base64` è½¬æ¢ä¹‹åï¼Œéƒ½åªä¼šå‡ºç°åœ¨è¿™ `64` ä¸ªå­—ç¬¦ä¸­ï¼ˆè¿˜æœ‰ä¸€ä¸ª `=` æ¯”è¾ƒç‰¹æ®Šï¼Œä¸å±äº `Base64` ä½†æœ‰æ—¶å€™ä¹Ÿä¼šå‡ºç°ï¼Œå®ƒæ˜¯å¡«å……ç¬¦å·ï¼‰ï¼Œä¸ä¼šå‡ºç°å…¶ä»–çš„å­—ç¬¦ï¼Œä¹Ÿå°±ä¸ä¼šå‡ºç°ä¹±ç ã€‚

> `Base64` çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¦‚ä½•ä¿è¯è½¬ç ä¹‹åçš„ä¿¡æ¯åœ¨è¿™`64` ä¸ªå­—ç¬¦ä¹‹å†…çš„ï¼Ÿ

å¤§å¤šæ•°è®¡ç®—æœºç§ï¼Œ1 ä¸ªå­—èŠ‚å  8 ä¸ª bitä½ï¼Œè€Œ `Base64` åˆ™æ˜¯å°†æ¯ 3 ä¸ªå­—èŠ‚ï¼ˆä¹Ÿå°±æ˜¯ 3 * 8 = 24  bitï¼‰æ‹†åˆ†ä¸º 4 ä¸ª 6 bit çš„å­—èŠ‚ï¼Œå¦‚æœè¦æ‹†åˆ†çš„ä¸è¶³ 3 ä¸ªå­—èŠ‚ï¼Œåˆ™ç”¨å¡«å……ç¬¦ `=` æ¥è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æœ€å¤šå¯ä»¥çœ‹åˆ°ä¸¤ä¸ª `=` ä¸”ä¸€å®šåœ¨æœ«å°¾ã€‚

6 bit ä¹Ÿå°±æ˜¯è¯´æœ€å¤§èƒ½è¡¨ç¤ºçš„å€¼ä¸ºï¼š `0011 1111`ï¼Œ ä¹Ÿå°±æ˜¯ 64ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆèƒ½ä¿è¯å…¶è½¬ç ç»“æœä¸€å®šåœ¨ 64 ä¸ªå­—ç¬¦å†…çš„åŸå› ï¼Œå› ä¸ºæœ€å¤§å€¼ä¸å¯èƒ½å¤§äº 64ã€‚

> å°±ç”¨ä¸Šé¢çš„ `flag` ä¸¾ä¸ªä¾‹å­å§ï¼Œå‡è®¾å·²çŸ¥ `flag` æ˜¯ `cyberpeace{Welcome_to_new_World!}`ï¼Œæ¥è®¡ç®—ä»–çš„ `Base64` è½¬ç ä¹‹åçš„å€¼

- æºå­—ç¬¦ä¸²ï¼š`cyberpeace{Welcome_to_new_World!}`
- ASCII ç ï¼š`99 121 98 101 114 112 101 97 99 101 123 87 101 108 99 111 109 101 95 116 111 95 110 101 119 95 87 111 114 108 100 33 125`	(ç©ºæ ¼ä»…ä»…æ˜¯ä¸ºäº†çœ‹èµ·æ¥æ–¹ä¾¿)
- äºŒè¿›åˆ¶ç ï¼š<font color=blue>01100011 01111001 01100010</font> 01100101 01110010 01110000 01100101 01100001 01100011 01100101 01111011 01010111 01100101 01101100 01100011 01101111 01101101 01100101 01011111 01110100 01101111 01011111 01101110 01100101 01110111 01011111 01010111 01101111 01110010 01101100 01100100 00100001 01111101	( æ¯ä¸ªå­—èŠ‚ 8 ä¸ª bit ä½)
- Base64ï¼š00<font color=blue>011000</font> 00<font color=blue>110111</font> 00<font color=blue>100101 </font>00<font color=blue>100010</font> 00011001 00010111 00001001 00110000 00011001 00010110 00000101 00100011 00011001 00010111 00101101 00010111 00011001 00010110 00110001 00100011 00011011 00110110 00110101 00100101 00010111 00110111 00010001 00101111 00010111 00110110 00111001 00100101 00011101 00110101 00111101 00010111 00011011 00110111 00001001 00101100 00011001 00000010 00000101 00111101	( æ¯ 3 * 8 ä¸ª bitï¼Œ æ‹†åˆ†æˆ 4 * 6 ä¸ªbitï¼Œé«˜ä½è¡¥ 2 ä¸ª 0 å‡‘å¤Ÿ 8 bit)
- è½¬ 10 è¿›åˆ¶ï¼š`24 55 37 34 25 23 9 48 25 22 5 35 25 23 45 23 25 22 49 35 27 54 53 37 23 55 17 47 23 54 57 37 29 53 61 23 27 55 9 44 25 2 5 61 `- è½¬ `Base64`ç¼–ç ï¼š`Y3liZXJwZWFjZXtXZWxjb21lX3RvX25ld19Xb3JsZCF9`	(`Base64` ç¼–ç è¡¨ä¸­ï¼Œä» 0 ~ 63 ä¾æ¬¡ä»£è¡¨ï¼šA~Z, a~z, 0~9, +, /ï¼‰ï¼ˆå› ä¸ºæºå­—ç¬¦ä¸² `cyberpeace{Welcome_to_new_World!}` çš„é•¿åº¦ä¸º `33`ï¼Œæ°å¥½æ˜¯ `3` çš„å€æ•°ï¼Œè¢« `Base64` ç»„åˆæˆäº† 33 / 3 * 4 = 44 ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æœ«å°¾ä¹Ÿä¸éœ€è¦ `=` è¡¥ä½ï¼‰
# é™„ä¸Šæµ‹è¯•æ—¶ä½¿ç”¨çš„è½¬ç ä»£ç ï¼ˆä¸ºäº†è¾“å‡ºæ•´é½ï¼Œæ–¹ä¾¿è§‚çœ‹ï¼Œæœ‰å¤šä¸ªå†—ä½™çš„ä»£ç å—ï¼‰

```java

class Solution {

    public static void main(String[] args) {
        String input = "cyberpeace{Welcome_to_new_World!}";
        System.out.println(input.length());
        // String input = "Y3liZXJwZWFjZXtXZWxjb21lX3RvX25ld19Xb3JsZCF9";   // Base64
        char[] chars = input.toCharArray();
        StringBuilder builder = new StringBuilder();
        for (char aChar : chars) {
            int n = aChar;
            String binaryString = Integer.toBinaryString(n);
            String str = String.format("%8s", binaryString).replace(" ", "0");
            builder.append(str);
            System.out.print(str + " ");
        }

        System.out.println();


        int startIndex = 0;
        /* ä»¥ä¸‹ ä¸‰ä¸ª while å¾ªç¯ä»£ç æ˜¯å‡ ä¹å®Œå…¨ä¸€æ ·çš„ï¼Œåªæ˜¯è¾“å‡ºçš„å†…å®¹ä¸ä¸€æ ·ï¼Œç›®çš„æ˜¯ä¸ºäº†å¯¹æ¯”çœ‹èµ·æ¥æ–¹ä¾¿ */
        while (builder.length() - startIndex >= 6){
            String substring = builder.substring(startIndex, Math.min(startIndex + 6, builder.length()));
            String replace = String.format("%8s", substring).replace(" ", "0");
            startIndex = startIndex + 6;
            System.out.print(replace + " ");
            int num = Integer.parseUnsignedInt(replace, 2);
            char c = (char) num;
            // System.out.print(c);
        }

        System.out.println();

        startIndex = 0;
        while (builder.length() - startIndex >= 6){
            String substring = builder.substring(startIndex, Math.min(startIndex + 6, builder.length()));
            String replace = String.format("%8s", substring).replace(" ", "0");
            startIndex = startIndex + 6;
            int num = Integer.parseUnsignedInt(replace, 2);
            char c = (char) num;
            System.out.print(num + " ");
        }

        System.out.println();

        startIndex = 0;
        while (builder.length() - startIndex >= 6){
            String substring = builder.substring(startIndex, Math.min(startIndex + 6, builder.length()));
            String replace = String.format("%8s", substring).replace(" ", "0");
            startIndex = startIndex + 6;
            int num = Integer.parseUnsignedInt(replace, 2);
            // base64  0 ~ 25: A ~ Z   26 ~ 51: a ~ z  52 ~ 61: 0 ~ 9   62: +   63: /       å¡«å……ï¼š =
            if (num <= 25){
                System.out.print((char)('A' + num));
            }
            if (num > 25 && num <= 51){
                System.out.print((char)('a' + num - 26));
            }
            if (num > 51 && num <= 61){
                System.out.print((char)('0' + num - 52));
            }
            if (num == 62){
                System.out.print("+");
            }
            if (num == 63){
                System.out.print("/");
            }
        }
        if (builder.length() - startIndex < 6 ){
            if (builder.length() - startIndex == 4) {
                System.out.print("=");
            }
            if (builder.length() - startIndex == 2){
                System.out.print("==");
            }
        }
    }
}
```

